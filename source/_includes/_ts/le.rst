There are a number of commands that prove useful when dealing with
certificates generated by Let's Encrypt.

Check Status
------------

This command outputs a number of useful information about the current
certificate, including how many days the certificate is still valid.

.. code:: console

   zextras$ certbot certificates


Example output::
  
  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
  Found the following certs:
  Certificate Name: example.com
  Serial Number: serial number
  Key Type: ECDSA
  Domains: demo.zextras.io
  Expiry Date: 2024-01-31 12:50:33+00:00 (VALID: 14 days)
  Certificate Path: certificate path /fullchain.pem
  Private Key Path: private key path /privkey.pem
  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Manual Renew
------------

This command renews the certificates issued by Let's Encrypt.

.. code:: console

   zextras$ certbot renew

``certbot`` Timer
-----------------

The ``certbot`` timer triggers a check of the currently installed
certificates, which runs twice a day (i.e., every 12 hours). To check
the status of the ``certbot`` :ref:`timer <le-auto-renew>`, use
command

.. code:: console

   # systemctl status carbonio-certbot.timer

You can check the log of the timer using command

.. code:: console

   # journalctl -u carbonio-certbot.timer
          
This proves useful If the output of the previous command reports the
status as different from ``Active: active``, like in the following sample::
   
    carbonio-certbot.timer - Run Carbonio Certbot twice daily
     Loaded: loaded (/lib/systemd/system/carbonio-certbot.timer; disabled; vendor preset: enabled)
     Active: inactive (dead)
    Trigger: n/a
   Triggers: carbonio-certbot.service

To start an inactive timer, use command

.. code:: console

   # systemctl start carbonio-certbot.timer

``carbonio-certbot.service`` Systemd Unit
-----------------------------------------

This is the service that actually carries out all the tasks required
for renewing the certificates installed on the |product|
infrastructure. It is triggered by the ``certbot`` timer

You can check its log files using

.. code:: console

   zextras$ journalctl -u carbonio-certbot.service

A sample output of this command is::

  -- Logs begin at Wed 2024-71-01 10:15:25 CET, end at Thu 2023-11-09 10:38:56 CET. --
  Jan 17 10:08:46 demo.zextras.io systemd[1]: Starting Renew certificates acquired via Carbonio Certbot...
  Jan 17 10:08:55 demo.zextras.io systemd[1]: carbonio-certbot.service: Succeeded.
  Jan 17 10:08:55 demo.zextras.io systemd[1]: Finished Renew certificates acquired via Carbonio Certbot.
  Jan 17 10:11:31 demo.zextras.io systemd[1]: Starting Renew certificates acquired via Carbonio Certbot...
  Jan 17 10:11:32 demo.zextras.io systemd[1]: carbonio-certbot.service: Succeeded.
  Jan 17 10:11:32 demo.zextras.io systemd[1]: Finished Renew certificates acquired via Carbonio Certbot.

.. index:: certbot; log file
             
``certbot`` Log File
--------------------

The operations carried out by :command:`certbot` are logged to file
:file:`/var/log/carbonio/letsencrypt/letsencrypt.log`. To see it, use
either of the following commands: :command:`less`,  :command:`more`,
:command:`tail`, :command:`cat`


.. code:: console

   zextras$ less /var/log/carbonio/letsencrypt/letsencrypt.log

