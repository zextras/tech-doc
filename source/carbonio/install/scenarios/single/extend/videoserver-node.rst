Video Server Node
=================

This section contains directions to set up the additional *Video
Server* Node. Most of the steps are the same as in the *Core* and
*Collaboration* Nodes. Click on the drop-downs to expand them.

.. dropdown:: Step 1: Configuration of Repositories

   .. rubric:: |product|

   .. include:: /_includes/_installation/step-repo-conf.rst

.. dropdown:: Step 2: Setting Hostname

   .. include:: /_includes/_installation/steps-hostname.rst

.. dropdown:: Step 3: System Upgrade and Package Installation

   After configuring the repositories, the installation of |product|
   requires to run a few commands.

   We start by updating and upgrading the system.

   .. include:: /_includes/_installation/pkg-upgrade.rst

   Next, we install all packages needed for |product|.

   .. tab-set::

      .. tab-item:: Ubuntu 22.04
         :sync: ubu22

         .. code:: console

            # apt install service-discover-agent \
            carbonio-videoserver-advanced carbonio-videorecorder

      .. tab-item:: Ubuntu 24.04
         :sync: ubu24

         .. code:: console

            # apt install service-discover-agent \
            carbonio-videoserver-advanced carbonio-videorecorder

      .. tab-item:: RHEL 8
         :sync: rhel8

         .. code:: console

            # dnf install service-discover-agent \
            carbonio-videoserver-advanced carbonio-videorecorder

      .. tab-item:: RHEL 9
         :sync: rhel9

         .. code:: console

            # dnf install service-discover-agent \
            carbonio-videoserver-advanced carbonio-videorecorder


.. dropdown:: Step 4: Bootstrap |product|

   To carry out this step, you need the **LDAP password** and the
   **Node hostname** that you have retrieved at Step 9 of the Core
   Node (see :ref:`Step 9 <n1-s9>`).

   .. include:: /_includes/_installation/step-bootstrap.rst

.. dropdown:: Step 5: Setup |mesh|

   To carry out this step, you need the |mesh| **secret** generated
   during the installation of the Core Node (see :ref:`Step 9
   <n1-s9>`).

   The |mesh| configuration is interactively generated by command

   .. code:: console

      # service-discover setup-wizard

   To complete |mesh| installation, run

   .. code:: console

      # pending-setups -a

.. dropdown:: Step 6: Configure |vs|

   .. rubric:: 1. Routing & mapping

   .. include:: /_includes/_installation/note-janus.rst

   Finally, enable and start the service with the commands

   .. code:: console

      # systemctl enable carbonio-videoserver.service
      # systemctl start  carbonio-videoserver.service

   .. rubric:: 2. Check Video Server & Broker

   To make sure that videoserver and message broker are connected
   successfully, check that in the carbonio-videoserver logs
   (:command:`journalctl -u carbonio-videoserver`) you find the line::

     RabbitMQEventHandler: Connected successfullySetup of RabbitMQ event
     handler completed
